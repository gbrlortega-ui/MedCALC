<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Anamnese – Recém-nascido (0–28 dias) | UBS</title>
<style>
  :root{
    --bg:#f5f5f7;
    --bg-section:#ffffff;
    --card:#fff;
    --text:#0f172a;
    --muted:#6b7280;
    --border:#e5e7eb;
    --focus:#4f46e5;
    --ok:#16a34a;
    --warn:#ea580c;
    --danger:#dc2626;
    --shadow-soft:0 18px 45px rgba(15,23,42,.12);
  }

  *{box-sizing:border-box}

  body{
    margin:0;
    background:radial-gradient(circle at top,#e5f0ff 0,#f5f5f7 45%,#f9fafb 100%);
    color:var(--text);
    font-family:system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    font-size:0.9rem; /* TEXTO GLOBAL UM POUCO MENOR */
  }

  /* LINKS */
  a{
    color:inherit;
    text-decoration:none;
  }

  /* HEADER / NAVBAR – mesmo padrão do index (estilo “Tesla”) */
  header.site-header{
    position:sticky;
    top:0;
    z-index:10;
    backdrop-filter:blur(16px);
    background:linear-gradient(to bottom,rgba(245,245,247,.95),rgba(245,245,247,.86));
    border-bottom:1px solid rgba(209,213,219,.7);
  }

  .nav-inner{
    max-width:1100px;
    margin:0 auto;
    padding:12px 20px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:24px;
  }

  .brand{
    display:flex;
    align-items:center;
    gap:10px;
  }

  .brand-mark{
    width:28px;
    height:28px;
    border-radius:999px;
    border:1px solid #111827;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:.85rem;
    font-weight:600;
  }

  .brand-text{
    display:flex;
    flex-direction:column;
    line-height:1.2;
  }

  .brand-title{
    font-size:.95rem;
    font-weight:600;
  }

  .brand-subtitle{
    font-size:.7rem;
    text-transform:uppercase;
    letter-spacing:.16em;
    color:var(--muted);
  }

  .nav-links{
    display:flex;
    align-items:center;
    gap:16px;
    font-size:.82rem;
    color:var(--muted);
    flex-wrap:wrap;
  }

  .nav-back{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:5px 10px;
    border-radius:999px;
    border:1px solid #d1d5db;
    font-size:.78rem;
    background:#ffffff;
    cursor:pointer;
    transition:background .15s,transform .12s,color .15s;
  }

  .nav-back span:first-child{
    font-size:.9rem;
    transform:translateY(1px);
  }

  .nav-back:hover{
    background:#111827;
    color:#f9fafb;
    transform:translateY(-1px);
  }

  .nav-pill{
    padding:5px 10px;
    border-radius:999px;
    border:1px solid #d1d5db;
    font-size:.72rem;
    text-transform:uppercase;
    letter-spacing:.14em;
    background:#ffffff;
  }

  /* PAGE WRAPPER */
  .page{
    max-width:1160px;
    margin:0 auto;
    padding:26px 16px 40px;
  }

  /* HERO / TÍTULO */
  .hero-rn{
    margin-bottom:18px;
  }

  .hero-badge{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:4px 11px;
    border-radius:999px;
    border:1px solid rgba(148,163,184,.5);
    font-size:.75rem;
    letter-spacing:.16em;
    text-transform:uppercase;
    color:var(--muted);
    background:rgba(255,255,255,.9);
    backdrop-filter:blur(18px);
  }

  .hero-badge-dot{
    width:6px;
    height:6px;
    border-radius:999px;
    background:#22c55e;
    box-shadow:0 0 0 4px rgba(34,197,94,.2);
  }

  .hero-title{
    margin:14px 0 4px;
    font-size:clamp(1.6rem,2.2vw,2.0rem); /* UM POUCO MENOR QUE ANTES */
    line-height:1.1;
    letter-spacing:.02em;
  }

  .hero-title span{
    display:block;
    font-weight:300;
    color:var(--muted);
  }

  .hero-text{
    margin:0;
    margin-top:6px;
    font-size:.9rem;
    color:var(--muted);
    max-width:720px;
  }

  /* FORMULÁRIO / CARDS */
  section.card{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:14px;
    padding:16px 16px;
    box-shadow:0 1px 2px rgba(0,0,0,.04);
  }

  .sub{color:var(--muted);margin:0 0 18px}

  .grid{display:grid;gap:12px;grid-template-columns:1fr}
  @media(min-width:980px){.grid{grid-template-columns:repeat(12,1fr)}}
  .col-2{grid-column:span 2}.col-3{grid-column:span 3}.col-4{grid-column:span 4}.col-5{grid-column:span 5}.col-6{grid-column:span 6}.col-7{grid-column:span 7}.col-8{grid-column:span 8}.col-12{grid-column:1/-1}

  label{
    display:block;
    margin-bottom:6px;
    font-weight:650;
    font-size:.9rem; /* MENOR QUE 1rem */
  }

  input,select,textarea{
    width:100%;
    padding:9px 10px;
    border:1px solid var(--border);
    border-radius:10px;
    font-size:.9rem; /* CAMPOS LEVEMENTE MENORES */
    background:#fff;
  }

  textarea{min-height:110px;resize:vertical}

  input:focus,select:focus,textarea:focus{
    border-color:var(--focus);
    box-shadow:0 0 0 3px rgba(79,70,229,.15);
    outline:none;
  }

  .hstack{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;background:#eef2ff;color:#4338ca;font-size:.8rem;font-weight:700}
  .hint{color:var(--muted);font-size:.85rem}
  .split{display:grid;grid-template-columns:1fr;gap:16px}
  @media(min-width:980px){.split{grid-template-columns:1.2fr .8fr}}
  .hr{height:1px;background:var(--border);margin:14px 0}
  .result{
    white-space:pre-wrap;
    border:1px dashed var(--border);
    padding:12px;
    border-radius:12px;
    background:#fcfcff;
    font-size:.9rem;
  }
  .kpi{display:flex;gap:10px;flex-wrap:wrap}
  .pill{padding:4px 10px;border-radius:999px;border:1px solid var(--border);font-size:.85rem}
  .pill.ok{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
  .pill.warn{background:#fff7ed;color:#9a3412;border-color:#fed7aa}
  .pill.danger{background:#fef2f2;color:#991b1b;border-color:#fecaca}
  .section-title{font-weight:800}
  .note{font-size:.9rem;color:#374151}
  .soft{color:#6b7280}
  .mini{font-size:.85rem;color:#6b7280}
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .check{display:flex;align-items:center;gap:8px}

  /* RESPONSIVO HEADER */
  @media (max-width:640px){
    .nav-inner{
      flex-direction:column;
      align-items:flex-start;
    }
    .page{
      padding:20px 14px 32px;
    }
  }

  /* IMPRESSÃO */
  @media print{
    @page{size:A4;margin:12mm}
    :root{--bg:#fff}
    body{background:#fff;font-size:0.9rem}
    header.site-header,
    .hero-rn{display:none!important}
    .page{max-width:none;padding:0}
    section.card{box-shadow:none;border:0;padding:0}
    .hr{margin:8px 0}
    .sub{margin-bottom:8px}
  }
</style>
</head>
<body>

<header class="site-header">
  <div class="nav-inner">
    <div class="brand">
      <div class="brand-mark">P</div>
      <div class="brand-text">
        <div class="brand-title">Medicina Integrada</div>
        <div class="brand-subtitle">Pediatria • Anamnese RN</div>
      </div>
    </div>
    <nav class="nav-links">
      <!-- volta para o index do módulo Pediatria (mesma pasta) -->
      <a href="index.html" class="nav-back">
        <span>⬅</span>
        <span>Voltar ao módulo Pediatria</span>
      </a>
      <span class="nav-pill">RN 0–28 dias</span>
    </nav>
  </div>
</header>

<main class="page">
  <!-- HERO -->
  <section class="hero-rn">
    <div class="hero-badge">
      <span class="hero-badge-dot"></span>
      ANAMNESE PEDIÁTRICA • RECÉM-NASCIDO
    </div>
    <h1 class="hero-title">
      Anamnese – Recém-nascido (0 a 28 dias)
      <span>Roteiro estruturado para primeiras consultas, visitas domiciliares e retornos precoces.</span>
    </h1>
    <p class="hero-text">
      Sequência sugerida: Identificação → QP → HMA → Pré-natal → Parto → Neonatal → Família /
      contexto → Desenvolvimento e reflexos → Alimentação / eliminação → Imunizações →
      Observações do cuidador → Síntese e plano.
    </p>
  </section>

  <!-- 1. Identificação -->
  <section class="card" style="margin-bottom:12px">
    <div class="hstack" style="margin-bottom:8px"><div class="badge">1. Identificação</div><span class="hint">Dados do RN e do(s) acompanhante(s).</span></div>
    <div class="grid">
      <div class="col-6"><label>Nome do recém-nascido</label><input id="id_nome" placeholder="se já definido"></div>
      <div class="col-3"><label>Data de nascimento</label><input id="id_dob" type="date"></div>
      <div class="col-3"><label>Hora de nascimento</label><input id="id_tob" type="time"></div>
      <div class="col-2"><label>Idade (dias)</label><input id="id_idade_d" type="number" min="0" placeholder="auto" title="Calculado pela data/hora de nascimento"></div>
      <div class="col-2"><label>Faixa etária</label><input id="id_faixa" placeholder="auto: precoce/tardio" readonly></div>
      <div class="col-2"><label>Sexo</label><input id="id_sexo" placeholder="F, M, intersexo"></div>
      <div class="col-6"><label>Mãe / Pai / Responsável</label><input id="id_resp" placeholder="nomes e vínculo"></div>
      <div class="col-4"><label>Naturalidade e procedência</label><input id="id_natproc" placeholder="Cidade/UF; bairro"></div>
      <div class="col-4"><label>Confiabilidade do informante</label>
        <select id="id_conf">
          <option value="">—</option>
          <option>Boa</option>
          <option>Regular</option>
          <option>Duvidosa</option>
        </select>
      </div>
    </div>
  </section>

  <div class="split">
    <div>
      <!-- 2. QP -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">2. QP</div><span class="section-title">Queixa principal</span></div>
        <input id="qp" placeholder="Ex.: 'Amarelado há 3 dias', 'não está mamando direito', 'choro excessivo', 'não evacua'">
      </section>

      <!-- 3. HMA -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">3. HMA</div><span class="section-title">História da Moléstia Atual</span> <span class="hint">Início/duração; evolução; intensidade; fatores de melhora/piora; sintomas associados; comportamento/reatividade.</span></div>
        <textarea id="hma" placeholder="Descrever a queixa: início, evolução, intensidade. Sintomas: febre, dificuldade para sugar, regurgitação/vômitos, evacuação, sonolência excessiva, gemência, cianose, irritabilidade. Comportamento/reatividade: responde a estímulos? choro vigoroso? suga bem? Condutas já adotadas e resposta."></textarea>
        <div class="mini">Sinais de alarme a rastrear: recusa alimentar, letargia, gemência, icterícia &lt; 24h, febre, apneia.</div>
      </section>

      <!-- 4. Antecedentes pré-natais -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">4. Pré-natal</div><span class="section-title">Antecedentes pré-natais</span></div>
        <div class="grid">
          <div class="col-3"><label>Gesta/Para/Aborto (GxPxA)</label><input id="pre_gpa" placeholder="GxPxA"></div>
          <div class="col-3"><label>Idade materna</label><input id="pre_idademat"></div>
          <div class="col-6"><label>Doenças maternas</label><input id="pre_doencas" placeholder="HAS, DM, infecções, anemia, cardiopatias"></div>
          <div class="col-6"><label>Infecções na gestação</label><input id="pre_infecc" placeholder="toxo, rubéola, CMV, sífilis, HIV, hepatite B"></div>
          <div class="col-6"><label>Exposições/uso</label><input id="pre_expo" placeholder="medicações, álcool, cigarro, drogas ilícitas"></div>
          <div class="col-6"><label>Sorologias maternas</label><input id="pre_soro" placeholder="VDRL, HBsAg, HIV, toxo, rubéola"></div>
          <div class="col-6"><label>Tipo sanguíneo/Rh (mãe/pai)</label><input id="pre_tipos" placeholder="mãe: ABO/Rh | pai: ABO/Rh"></div>
          <div class="col-6"><label>Acompanhamento pré-natal</label><input id="pre_prenatal" placeholder="nº de consultas, exames realizados"></div>
          <div class="col-6"><label>Intercorrências obstétricas</label><input id="pre_interc" placeholder="sangramento, APP, oligo/polidrâmnio, DHEG"></div>
          <div class="col-6"><label>Vacinação materna</label><input id="pre_vac" placeholder="influenza, dTpa"></div>
        </div>
      </section>

      <!-- 5. Antecedentes do parto -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">5. Parto</div><span class="section-title">Antecedentes do parto</span></div>
        <div class="grid">
          <div class="col-3"><label>Idade gestacional (semanas)</label><input id="parto_ig" placeholder="Capurro ou DUM"></div>
          <div class="col-3"><label>Local/Tipo</label><input id="parto_tipo" placeholder="hospitalar/domic.; normal/cesárea/fórceps"></div>
          <div class="col-3"><label>Indicação</label><input id="parto_indic" placeholder="ex.: sofrimento fetal"></div>
          <div class="col-3"><label>ROM (horas)</label><input id="parto_rom" type="number" min="0" placeholder="≥18h = risco"></div>
          <div class="col-4"><label>Líquido amniótico</label><input id="parto_liq" placeholder="cor, odor, mecônio"></div>
          <div class="col-4"><label>Cordão umbilical</label><input id="parto_cord" placeholder="circular, nó, prolapso"></div>
          <div class="col-4"><label>Apgar 1’ / 5’</label><input id="parto_apgar" placeholder="ex.: 8/9"></div>
          <div class="col-4"><label>Reanimação neonatal</label><input id="parto_rean" placeholder="O₂, VPP, aspiração, intubação"></div>
          <div class="col-3"><label>Peso (g)</label><input id="parto_peso" type="number"></div>
          <div class="col-3"><label>Comprimento (cm)</label><input id="parto_comp" type="number" step="0.1"></div>
          <div class="col-3"><label>PC (cm)</label><input id="parto_pc" type="number" step="0.1"></div>
          <div class="col-3"><label>Classificação IG</label>
            <select id="parto_class">
              <option value="">—</option>
              <option>AIG</option>
              <option>PIG</option>
              <option>GIG</option>
            </select>
          </div>
          <div class="col-6"><label>Primeiro choro/respiração espontânea</label><input id="parto_choro" placeholder="sim/não + observações"></div>
          <div class="col-6"><label>Outras observações do parto</label><input id="parto_obs"></div>
        </div>
      </section>

      <!-- 6. Antecedentes neonatais -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">6. Neonatal</div><span class="section-title">Pós-parto imediato/tardio</span></div>
        <div class="grid">
          <div class="col-4"><label>Alojamento</label><input id="neo_aloj" placeholder="conjunto / UTI neonatal"></div>
          <div class="col-4"><label>Internação (dias)</label><input id="neo_intern" type="number"></div>
          <div class="col-4"><label>Motivo da internação</label><input id="neo_motivo"></div>
          <div class="col-12"><label>Icterícia neonatal</label><input id="neo_icter" placeholder="início, intensidade, fototerapia"></div>
          <div class="col-12"><label>Outras intercorrências</label><input id="neo_interc" placeholder="hipoglicemia, infecções, desconforto resp., convulsões, malformações"></div>
          <div class="col-12"><label>Triagens neonatais</label>
            <input id="neo_tri" placeholder="pezinho, coraçãozinho, orelhinha, olhinho">
          </div>
          <div class="col-12"><label>Alta hospitalar</label><input id="neo_alta" placeholder="data e orientações recebidas"></div>
        </div>
      </section>

      <!-- 7. Alimentação (RN) -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">7. Alimentação</div><span class="section-title">Aleitamento e eliminação</span></div>
        <div class="grid">
          <div class="col-4"><label>Tipo de aleitamento</label><input id="ali_tipo" placeholder="materno exclusivo, misto, fórmula"></div>
          <div class="col-4"><label>Início da amamentação</label><input id="ali_inicio" placeholder="primeira hora de vida?"></div>
          <div class="col-4"><label>Pega/sucção</label><input id="ali_pega" placeholder="eficaz? dor? fissuras?"></div>
          <div class="col-4"><label>Intervalo/duração</label><input id="ali_inter" placeholder="intervalo entre mamadas e tempo"></div>
          <div class="col-4"><label>Ganho ponderal</label><input id="ali_gp" placeholder="desde o nascimento"></div>
          <div class="col-4"><label>Regurgitação/Vômitos</label><input id="ali_regurg" placeholder="frequência, volume, jatos"></div>
          <div class="col-6"><label>Evacuações</label><input id="ali_ev" placeholder="nº, cor e consistência: mecônio → fezes amareladas"></div>
          <div class="col-6"><label>Diurese</label><input id="ali_diurese" placeholder="micções/dia, coloração da urina"></div>
          <div class="col-12"><label>Higiene do coto umbilical</label><input id="ali_coto"></div>
        </div>
      </section>

      <!-- 8. Desenvolvimento e comportamento neonatal -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">8. Desenvolvimento</div><span class="section-title">Comportamento e reflexos do RN</span></div>
        <div class="grid">
          <div class="col-6"><label>Tônus/movimentação</label><input id="dev_tonus" placeholder="postura em flexão, movimentação espontânea"></div>
          <div class="col-6"><label>Reatividade</label><input id="dev_reat" placeholder="responde a estímulos, choro vigoroso, suga/deglute"></div>
          <div class="col-12"><label>Reflexos primitivos</label>
            <input id="dev_reflex" placeholder="Moro, sucção, preensão palmar/plantar, busca, marcha automática">
          </div>
        </div>
      </section>

      <!-- 9. História familiar -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">9. Familiar</div><span class="section-title">História familiar</span></div>
        <div class="grid">
          <div class="col-6"><label>Consanguinidade dos pais</label><input id="fam_consan"></div>
          <div class="col-6"><label>Doenças genéticas/metabólicas</label><input id="fam_doenc"></div>
          <div class="col-6"><label>Morte neonatal/infantil em irmãos</label><input id="fam_mortes"></div>
          <div class="col-6"><label>Icterícia grave / incompatibilidade Rh/ABO</label><input id="fam_icter"></div>
        </div>
      </section>

      <!-- 10. Condições socioambientais -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">10. Socioambiental</div><span class="section-title">Condições e segurança</span></div>
        <div class="grid">
          <div class="col-6"><label>Composição familiar/vínculos</label><input id="soc_comp"></div>
          <div class="col-6"><label>Condições da casa</label><input id="soc_cond" placeholder="ventilação, saneamento, local de dormir"></div>
          <div class="col-6"><label>Exposições</label><input id="soc_expos" placeholder="fumantes, animais, mofo"></div>
          <div class="col-6"><label>Rede de apoio</label><input id="soc_apoio" placeholder="avós, UBS, visitas domiciliares"></div>
          <div class="col-12"><label>Segurança</label><input id="soc_seg" placeholder="prevenção de quedas, bebê conforto"></div>
        </div>
      </section>

      <!-- 11. Imunizações -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">11. Imunizações</div><span class="section-title">Ao nascimento</span></div>
        <div class="grid">
          <div class="col-6"><label>BCG</label><input id="vac_bcg" placeholder="aplicada? data/lote/local"></div>
          <div class="col-6"><label>Hepatite B (1ª dose)</label><input id="vac_hepb" placeholder="aplicada? data/lote/local"></div>
          <div class="col-12"><label>Observações/pendências</label><input id="imuniz" placeholder="verificar registro no cartão e orientar continuidade"></div>
        </div>
      </section>

      <!-- 12. Observações do cuidador -->
      <section class="card" style="margin-bottom:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">12. Observações</div><span class="section-title">Do cuidador</span></div>
        <textarea id="obs_cuid" placeholder="Dúvidas, inseguranças, dificuldades com o bebê; estado emocional materno (rastrear depressão pós-parto); apoio familiar/rede social"></textarea>
      </section>

      <!-- 13. Síntese e plano -->
      <section class="card">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">13. Síntese/Plano</div><span class="section-title">Avaliativa</span></div>
        <div class="grid">
          <div class="col-12"><label>Fatores de risco perinatais</label><textarea id="sint_risco"></textarea></div>
          <div class="col-12"><label>Classificação do RN</label>
            <input id="sint_class" placeholder="risco habitual ou alto risco; justificar">
          </div>
          <div class="col-12"><label>Orientações</label><textarea id="sint_orient" placeholder="aleitamento, higiene/coto, sinais de alerta, retorno/puericultura"></textarea></div>
          <div class="col-12"><label>Condutas/Encaminhamentos</label><textarea id="sint_cond"></textarea></div>
        </div>
      </section>
    </div>

    <!-- Painel lateral de síntese automática -->
    <div>
      <section class="card">
        <div class="hstack" style="justify-content:space-between;align-items:center">
          <strong>Síntese da Anamnese (gerada automaticamente)</strong>
          <span class="hint">Imprimir: Ctrl+P / ⌘P</span>
        </div>
        <div class="hr"></div>
        <div class="kpi" id="kpi_bar">
          <div class="pill" id="kpi_idade">Idade: —</div>
          <div class="pill" id="kpi_faixa">Faixa etária: —</div>
          <div class="pill" id="kpi_vac">Vacinas nasc.: —</div>
          <div class="pill" id="kpi_tri">Triagens: —</div>
          <div class="pill" id="kpi_rom">ROM: —</div>
        </div>
        <div class="hr"></div>
        <div class="result" id="preview">Preencha os campos para gerar a nota.</div>
      </section>

      <section class="card" style="margin-top:14px">
        <div class="hstack" style="margin-bottom:8px"><div class="badge">Checklist</div><span class="section-title">Sinais de Alarme (RN)</span></div>
        <ul class="soft" style="margin:0 0 0 18px; padding:0 0 0 4px; line-height:1.6">
          <li>Recusa alimentar, letargia/hipotonia, irritabilidade inconsolável</li>
          <li>Gemência, tiragens, batimento de asa de nariz, cianose, apneia</li>
          <li>Desidratação (fontanela deprimida, poucas fraldas, mucosas secas)</li>
          <li>Vômitos biliosos, distensão abdominal</li>
          <li>Icterícia nas primeiras 24h de vida</li>
          <li>Febre em &lt; 3 meses, febre persistente ou convulsões</li>
        </ul>
      </section>
    </div>
  </div>

  <p class="hint" style="margin-top:12px">Dica: registre a fala do cuidador na QP e traduza tecnicamente na HMA. Verifique triagens neonatais e BCG/HepB nas primeiras consultas.</p>
</main>

<script>
(function(){
  const $=id=>document.getElementById(id);
  const fields=[
    'id_nome','id_dob','id_tob','id_idade_d','id_faixa','id_sexo','id_resp','id_natproc','id_conf',
    'qp','hma',
    'pre_gpa','pre_idademat','pre_doencas','pre_infecc','pre_expo','pre_soro','pre_tipos','pre_prenatal','pre_interc','pre_vac',
    'parto_ig','parto_tipo','parto_indic','parto_rom','parto_liq','parto_cord','parto_apgar','parto_rean','parto_peso','parto_comp','parto_pc','parto_class','parto_choro','parto_obs',
    'neo_aloj','neo_intern','neo_motivo','neo_icter','neo_interc','neo_tri','neo_alta',
    'ali_tipo','ali_inicio','ali_pega','ali_inter','ali_gp','ali_regurg','ali_ev','ali_diurese','ali_coto',
    'dev_tonus','dev_reat','dev_reflex',
    'fam_consan','fam_doenc','fam_mortes','fam_icter',
    'soc_comp','soc_cond','soc_expos','soc_apoio','soc_seg',
    'vac_bcg','vac_hepb','imuniz',
    'obs_cuid',
    'sint_risco','sint_class','sint_orient','sint_cond'
  ];

  fields.forEach(id=>$(id)?.addEventListener('input',update));

  // Cálculo automático da idade (dias) e classificação precoce/tardio
  function calcAgeDays(){
    const dobVal = $('id_dob').value;
    const tobVal = $('id_tob').value;
    if(!dobVal) return null;
    const dob = new Date(dobVal + (tobVal? 'T'+tobVal: 'T00:00'));
    const now = new Date();
    const diffMs = now - dob;
    if(diffMs < 0) return 0;
    return Math.floor(diffMs / (1000*60*60*24));
  }

  $('id_dob')?.addEventListener('change',()=>{
    const d = calcAgeDays();
    if(d!=null){ $('id_idade_d').value = Math.max(0,d); }
    update();
  });
  $('id_tob')?.addEventListener('change',()=>{
    const d = calcAgeDays();
    if(d!=null){ $('id_idade_d').value = Math.max(0,d); }
    update();
  });

  function lineIf(label,val){const v=(val||'').toString().trim();return v?`${label}: ${v}`:''}
  function join(lines,sep='\n'){return lines.filter(Boolean).join(sep)||'—'}

  function inferFaixa(idadeDias){
    if(idadeDias==='' || idadeDias==null) return '';
    const d = Number(idadeDias);
    if(isNaN(d)) return '';
    return d<=7? 'neonato precoce (0–7d)': 'neonato tardio (8–28d)';
  }

  function badges(){
    const idade=($('id_idade_d').value||'').trim();
    const faixa = inferFaixa(idade);
    $('id_faixa').value = faixa || '';
    $('kpi_idade').textContent = `Idade: ${idade? idade+"d":"—"}`;
    $('kpi_faixa').textContent = `Faixa etária: ${faixa||'—'}`;
    const vac_bcg = ($('vac_bcg').value||'').trim();
    const vac_hepb = ($('vac_hepb').value||'').trim();
    let vacResumo = '—';
    if(vac_bcg || vac_hepb){
      const v = [];
      if(vac_bcg) v.push('BCG');
      if(vac_hepb) v.push('HepB');
      vacResumo = v.join(' + ');
    }
    $('kpi_vac').textContent = `Vacinas nasc.: ${vacResumo}`;
    const tri = ($('neo_tri').value||'').trim();
    $('kpi_tri').textContent = `Triagens: ${tri? 'registradas':''}` || 'Triagens: —';
    const rom = ($('parto_rom').value||'').trim();
    $('kpi_rom').textContent = `ROM: ${rom? rom+'h':'—'}`;
  }

  function update(){
    badges();

    const blocoId = join([
      lineIf('Nome', $('id_nome').value),
      lineIf('Data de nascimento', $('id_dob').value),
      lineIf('Hora de nascimento', $('id_tob').value),
      lineIf('Idade (dias)', $('id_idade_d').value),
      lineIf('Faixa etária', $('id_faixa').value),
      lineIf('Sexo', $('id_sexo').value),
      lineIf('Mãe/Pai/Responsável', $('id_resp').value),
      lineIf('Naturalidade/Procedência', $('id_natproc').value),
      lineIf('Confiabilidade', $('id_conf').value)
    ], ' · ');

    const blocoQP = $('qp').value || '—';
    const blocoHMA = $('hma').value || '—';

    const blocoPre = join([
      lineIf('GxPxA', $('pre_gpa').value),
      lineIf('Idade materna', $('pre_idademat').value),
      lineIf('Doenças maternas', $('pre_doencas').value),
      lineIf('Infecções na gestação', $('pre_infecc').value),
      lineIf('Exposições/uso', $('pre_expo').value),
      lineIf('Sorologias maternas', $('pre_soro').value),
      lineIf('Tipo sanguíneo/Rh (mãe/pai)', $('pre_tipos').value),
      lineIf('Pré-natal', $('pre_prenatal').value),
      lineIf('Intercorrências obstétricas', $('pre_interc').value),
      lineIf('Vacinação materna', $('pre_vac').value)
    ]);

    const blocoParto = join([
      lineIf('IG (semanas)', $('parto_ig').value),
      lineIf('Local/Tipo', $('parto_tipo').value),
      lineIf('Indicação', $('parto_indic').value),
      lineIf('ROM (h)', $('parto_rom').value),
      lineIf('Líquido amniótico', $('parto_liq').value),
      lineIf('Cordão', $('parto_cord').value),
      lineIf('Apgar 1’/5’', $('parto_apgar').value),
      lineIf('Reanimação', $('parto_rean').value),
      lineIf('Peso (g)', $('parto_peso').value),
      lineIf('Comprimento (cm)', $('parto_comp').value),
      lineIf('PC (cm)', $('parto_pc').value),
      lineIf('Classificação IG', $('parto_class').value),
      lineIf('Primeiro choro/respiração', $('parto_choro').value),
      lineIf('Observações', $('parto_obs').value)
    ]);

    const blocoNeo = join([
      lineIf('Alojamento', $('neo_aloj').value),
      lineIf('Internação (dias)', $('neo_intern').value),
      lineIf('Motivo', $('neo_motivo').value),
      lineIf('Icterícia', $('neo_icter').value),
      lineIf('Intercorrências', $('neo_interc').value),
      lineIf('Triagens', $('neo_tri').value),
      lineIf('Alta hospitalar', $('neo_alta').value)
    ]);

    const blocoAli = join([
      lineIf('Aleitamento', $('ali_tipo').value),
      lineIf('Início da amamentação', $('ali_inicio').value),
      lineIf('Pega/sucção', $('ali_pega').value),
      lineIf('Intervalo/duração', $('ali_inter').value),
      lineIf('Ganho ponderal', $('ali_gp').value),
      lineIf('Regurgitação/vômitos', $('ali_regurg').value),
      lineIf('Evacuações', $('ali_ev').value),
      lineIf('Diurese', $('ali_diurese').value),
      lineIf('Coto umbilical', $('ali_coto').value)
    ]);

    const blocoDev = join([
      lineIf('Tônus/movimentação', $('dev_tonus').value),
      lineIf('Reatividade', $('dev_reat').value),
      lineIf('Reflexos primitivos', $('dev_reflex').value)
    ]);

    const blocoFam = join([
      lineIf('Consanguinidade', $('fam_consan').value),
      lineIf('Doenças genéticas/metabólicas', $('fam_doenc').value),
      lineIf('Morte neonatal/infantil', $('fam_mortes').value),
      lineIf('História de icterícia grave / Rh/ABO', $('fam_icter').value)
    ]);

    const blocoSoc = join([
      lineIf('Composição/vínculos', $('soc_comp').value),
      lineIf('Condições da casa', $('soc_cond').value),
      lineIf('Exposições', $('soc_expos').value),
      lineIf('Rede de apoio', $('soc_apoio').value),
      lineIf('Segurança', $('soc_seg').value)
    ]);

    const blocoImun = join([
      lineIf('BCG', $('vac_bcg').value),
      lineIf('Hepatite B (1ª dose)', $('vac_hepb').value),
      lineIf('Obs./pendências', $('imuniz').value)
    ]);

    const blocoObs = $('obs_cuid').value || '—';

    const blocoSint = join([
      lineIf('Fatores de risco perinatais', $('sint_risco').value),
      lineIf('Classificação do RN', $('sint_class').value),
      lineIf('Orientações', $('sint_orient').value),
      lineIf('Condutas/Encaminhamentos', $('sint_cond').value)
    ]);

    const nota=
`1. Identificação
${blocoId}

2. Queixa principal (QP)
${blocoQP}

3. História da Moléstia Atual (HMA)
${blocoHMA}

4. Antecedentes pré-natais
${blocoPre}

5. Antecedentes do parto
${blocoParto}

6. Antecedentes neonatais (pós-parto imediato/tardio)
${blocoNeo}

7. Alimentação (RN)
${blocoAli}

8. Desenvolvimento e comportamento neonatal
${blocoDev}

9. História familiar
${blocoFam}

10. Condições socioambientais
${blocoSoc}

11. Imunizações ao nascimento
${blocoImun}

12. Observações do cuidador
${blocoObs}

13. Síntese e plano
${blocoSint}`;

    $('preview').textContent=nota.trim();
  }

  // inicializa
  update();
})();
</script>
</body>
</html>
