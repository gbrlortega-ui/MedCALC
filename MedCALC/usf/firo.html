<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FIRO ‚Äì Fundamental Interpersonal Relations Orientation</title>
<style>
:root{
  --bg:#f5f5f7;
  --card:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --ok:#065f46;
  --ok-bg:#d1fae5;
  --warn:#92400e;
  --warn-bg:#ffedd5;
  --bad:#7f1d1d;
  --bad-bg:#fee2e2;
  --focus:#4f46e5;
  --shadow-soft:0 18px 45px rgba(15,23,42,.12);
}

/* Reset b√°sico */
*{box-sizing:border-box}
html,body{
  margin:0;
  padding:0;
}

/* Fundo geral estilo ‚Äúsite‚Äù */
body{
  background:radial-gradient(circle at top,#e5f0ff 0,#f5f5f7 45%,#f9fafb 100%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--text);
  font-size:0.9rem;
}

a{
  color:inherit;
  text-decoration:none;
}

/* HEADER / NAVBAR */
header.site-header{
  position:sticky;
  top:0;
  z-index:10;
  backdrop-filter:blur(16px);
  background:linear-gradient(to bottom,rgba(245,245,247,.95),rgba(245,245,247,.86));
  border-bottom:1px solid rgba(209,213,219,.7);
}

.nav-inner{
  max-width:1100px;
  margin:0 auto;
  padding:12px 20px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:24px;
}

.brand{
  display:flex;
  align-items:center;
  gap:10px;
}

.brand-mark{
  width:28px;
  height:28px;
  border-radius:999px;
  border:1px solid #111827;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:.85rem;
  font-weight:600;
}

.brand-text{
  display:flex;
  flex-direction:column;
  line-height:1.2;
}

.brand-title{
  font-size:.95rem;
  font-weight:600;
}

.brand-subtitle{
  font-size:.7rem;
  text-transform:uppercase;
  letter-spacing:.16em;
  color:var(--muted);
}

.nav-links{
  display:flex;
  align-items:center;
  gap:16px;
  font-size:.82rem;
  color:var(--muted);
  flex-wrap:wrap;
}

.nav-back{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:5px 10px;
  border-radius:999px;
  border:1px solid #d1d5db;
  font-size:.78rem;
  background:#ffffff;
  cursor:pointer;
  transition:background .15s,transform .12s,color .15s;
}

.nav-back span:first-child{
  font-size:.9rem;
  transform:translateY(1px);
}

.nav-back:hover{
  background:#111827;
  color:#f9fafb;
  transform:translateY(-1px);
}

.nav-pill{
  padding:5px 10px;
  border-radius:999px;
  border:1px solid #d1d5db;
  font-size:.72rem;
  text-transform:uppercase;
  letter-spacing:.14em;
  background:#ffffff;
}

/* PAGE WRAPPER */
.page{
  max-width:950px;
  margin:0 auto;
  padding:28px 20px 60px;
}

/* HERO FIRO */
.hero-firo{
  margin-bottom:18px;
}

.hero-badge{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:4px 11px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.5);
  font-size:.75rem;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:var(--muted);
  background:rgba(255,255,255,.85);
  backdrop-filter:blur(18px);
}

.hero-badge-dot{
  width:6px;
  height:6px;
  border-radius:999px;
  background:#22c55e;
  box-shadow:0 0 0 4px rgba(34,197,94,.2);
}

.hero-title{
  margin:14px 0 4px;
  font-size:clamp(1.7rem,2.3vw,2rem);
  line-height:1.1;
  letter-spacing:.02em;
}

.hero-title span{
  display:block;
  font-weight:300;
  color:var(--muted);
}

.hero-text{
  margin:0;
  margin-top:6px;
  font-size:.92rem;
  color:var(--muted);
  max-width:640px;
}

/* CARD WRAPPER em volta do instrumento */
.card-wrapper{
  background:var(--card);
  border-radius:20px;
  border:1px solid var(--border);
  box-shadow:var(--shadow-soft);
  padding:16px 16px 14px;
}

/* ---- CONTE√öDO ORIGINAL DO FIRO (ajustado dentro do card) ---- */

.shell{
  max-width:100%;
  margin:0 auto;
  padding:2px 2px 4px;
  background:transparent;
  box-sizing:border-box;
}

/* Cabe√ßalho interno do instrumento */
.header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
}
.title-block h1{
  margin:0;
  font-size:1.3rem;
}
.title-block .sub{
  margin:4px 0 0;
  color:var(--muted);
  font-size:.85rem;
}
.badge{
  display:inline-block;
  padding:4px 8px;
  border-radius:8px;
  border:1px solid var(--border);
  font-size:.75rem;
  color:var(--muted);
  background:#f9fafb;
}
.tag-mini{
  font-size:.75rem;
  color:var(--muted);
}

/* Grid principal */
.main-grid{
  margin-top:10px;
  display:grid;
  grid-template-columns:1.05fr 1.15fr;
  gap:12px;
}

/* Cards */
.card{
  background:var(--card);
  border-radius:12px;
  border:1px solid var(--border);
  box-shadow:0 1px 3px rgba(15,23,42,.06);
  padding:10px;
  box-sizing:border-box;
  display:flex;
  flex-direction:column;
  gap:6px;
}

/* Tabelas / inputs */
table{
  width:100%;
  border-collapse:collapse;
  font-size:.86rem;
}
th,td{
  padding:6px 4px;
  border-bottom:1px solid var(--border);
  text-align:center;
}
th{
  background:#f9fafb;
  font-weight:600;
}
th:first-child,td:first-child{
  text-align:left;
  padding-left:6px;
}
input[type=number]{
  width:60px;
  padding:4px 5px;
  border:1px solid var(--border);
  border-radius:8px;
  text-align:center;
  font-size:.86rem;
  box-sizing:border-box;
}
input[type=number]:focus,
input[type=text]:focus{
  border-color:var(--focus);
  box-shadow:0 0 0 3px rgba(79,70,229,.18);
  outline:none;
}

label{
  font-size:.8rem;
  font-weight:600;
  color:var(--muted);
}
input[type=text]{
  width:100%;
  padding:6px 8px;
  border:1px solid var(--border);
  border-radius:8px;
  font-size:.86rem;
  box-sizing:border-box;
}

/* Painel de resultado */
#painel{
  border-radius:10px;
  border:1px dashed var(--border);
  padding:8px;
  background:#f9fafb;
  font-size:.86rem;
}

/* KPIs */
.kpis{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:6px;
}
.kpi{
  border:1px solid var(--border);
  border-radius:10px;
  padding:6px;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:6px;
  background:#ffffff;
}
.value{
  font-size:1.3rem;
  font-weight:800;
}
.small{
  font-size:.8rem;
  color:var(--muted);
}
.pill{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:4px 8px;
  border-radius:999px;
  font-size:.72rem;
  font-weight:700;
  white-space:nowrap;
}
.pill-ok{background:var(--ok-bg);color:var(--ok);}
.pill-warn{background:var(--warn-bg);color:var(--warn);}
.pill-bad{background:var(--bad-bg);color:var(--bad);}

/* Bloco interpreta√ß√£o */
.block-title{
  font-size:.88rem;
  font-weight:700;
  margin-bottom:2px;
}
.point-list{
  margin:0;
  padding-left:14px;
  font-size:.8rem;
  color:var(--muted);
}
.point-list li+li{
  margin-top:2px;
}

/* Faixas explicativas curtas */
.legend{
  display:flex;
  justify-content:space-between;
  gap:8px;
  margin-top:4px;
}
.legend-col{
  flex:1;
  font-size:.78rem;
  color:var(--muted);
}

/* Bot√µes navega√ß√£o */
.btns{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:8px;
}
button{
  background:var(--focus);
  color:#fff;
  border:none;
  padding:6px 10px;
  border-radius:999px;
  cursor:pointer;
  font-size:0.8rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:4px;
  box-shadow:0 4px 10px rgba(15,23,42,.2);
}
button:hover{
  background:#3730a3;
}

/* FOOTER */
footer.site-footer{
  border-top:1px solid rgba(209,213,219,.7);
  margin-top:32px;
  padding:14px 20px 20px;
  font-size:.8rem;
  color:var(--muted);
  display:flex;
  justify-content:space-between;
  gap:8px;
  flex-wrap:wrap;
  max-width:950px;
  margin-left:auto;
  margin-right:auto;
}
footer.site-footer strong{
  font-weight:500;
  color:#111827;
}

/* Responsivo */
@media (max-width:900px){
  .page{
    padding:22px 16px 40px;
  }
  .main-grid{
    grid-template-columns:1fr;
  }
  .kpis{
    grid-template-columns:1fr;
  }
}
@media (max-width:640px){
  .nav-inner{
    flex-direction:column;
    align-items:flex-start;
  }
}

/* IMPRESS√ÉO ‚Äì A5, focando s√≥ no instrumento */
@media print{
  @page{
    size:A5 portrait;
    margin:0.3cm;
  }
  header.site-header,
  footer.site-footer,
  .hero-firo{
    display:none !important;
  }
  body{
    background:#fff;
    font-size:0.7rem;
  }
  .page{
    max-width:none;
    padding:4px 3px;
    margin:0;
  }
  .card-wrapper{
    border:none;
    box-shadow:none;
    padding:0;
  }
  .shell{
    max-width:none;
    padding:0;
  }
  .title-block h1{
    font-size:1rem;
    margin-bottom:2px;
  }
  .title-block .sub,
  .badge,
  .tag-mini,
  .btns{
    display:none !important;
  }
  .card{
    box-shadow:none;
    border-color:#bbb;
    padding:4px;
    margin-top:3px;
    border-radius:4px;
  }
  .main-grid{
    grid-template-columns:1fr;
    gap:4px;
  }
  table{
    font-size:0.6rem;
  }
  th,td{
    padding:2px 3px;
  }
  th{
    font-size:0.6rem;
  }
  input[type=number]{
    width:46px;
    padding:2px 3px;
    font-size:0.6rem;
  }
  input[type=text]{
    padding:3px 4px;
    font-size:0.6rem;
  }
  #painel{
    padding:4px;
    font-size:0.62rem;
  }
  .kpi{
    padding:4px;
  }
  .value{
    font-size:0.85rem;
  }
  .pill{
    font-size:0.55rem;
    padding:2px 4px;
  }
  .small,
  .legend-col,
  .point-list{
    font-size:0.55rem;
  }
}
</style>
</head>
<body>

  <!-- HEADER GLOBAL -->
  <header class="site-header">
    <div class="nav-inner">
      <div class="brand">
        <div class="brand-mark">M</div>
        <div class="brand-text">
          <div class="brand-title">Medicina Integrada</div>
          <div class="brand-subtitle">USF ‚Ä¢ FIRO</div>
        </div>
      </div>
      <nav class="nav-links">
        <a href="index.html" class="nav-back">
          <span>‚¨Ö</span>
          <span>Voltar √† USF</span>
        </a>
        <span class="nav-pill">FIRO</span>
      </nav>
    </div>
  </header>

  <main class="page">
    <!-- HERO -->
    <section class="hero-firo">
      <div class="hero-badge">
        <span class="hero-badge-dot"></span>
        AVALIA√á√ÉO FAMILIAR ‚Ä¢ FIRO
      </div>
      <h1 class="hero-title">
        FIRO ‚Äì Necessidades interpessoais
        <span>Inclus√£o, Controle e Afei√ß√£o nas dimens√µes Expressado (E) e Desejado (D).</span>
      </h1>
      <p class="hero-text">
        Instrumento baseado em Will Schutz (1958), √∫til para discutir como a fam√≠lia
        lida com pertencimento, organiza√ß√£o e v√≠nculo afetivo. A leitura combina intensidade
        das necessidades e congru√™ncia entre o que √© expresso e o que √© desejado.
      </p>
    </section>

    <!-- CARD COM O INSTRUMENTO -->
    <section class="card-wrapper">
      <div class="shell">
        <header class="header">
          <div class="title-block">
            <h1>FIRO ‚Äì Necessidades Interpessoais</h1>
            <p class="sub">
              Baseado em Will Schutz (1958). Mede <b>Inclus√£o (I)</b>, <b>Controle (C)</b> e <b>Afei√ß√£o (A)</b>
              nas dimens√µes <b>Expressado (E)</b> e <b>Desejado (D)</b>.
            </p>
          </div>
          <div style="text-align:right;display:flex;flex-direction:column;gap:6px;align-items:flex-end;">
            <span class="badge">
              Mais pontos ‚â† melhor. Observe tamb√©m a <b>congru√™ncia</b> entre E e D.
            </span>
            <span class="tag-mini">Uso cl√≠nico / familiar r√°pido</span>
          </div>
        </header>

        <div class="main-grid">
          <!-- LADO ESQUERDO: inputs -->
          <section class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <span style="font-weight:600;font-size:.9rem;">Pontua√ß√µes FIRO</span>
              <span class="small">0‚Äì9 por subdimens√£o</span>
            </div>
            <table>
              <tr>
                <th>Dimens√£o</th>
                <th>Expressado (E)</th>
                <th>Desejado (D)</th>
              </tr>
              <tr>
                <td>Inclus√£o (I)</td>
                <td><input type="number" id="IE" min="0" max="9" placeholder="0‚Äì9"></td>
                <td><input type="number" id="ID" min="0" max="9" placeholder="0‚Äì9"></td>
              </tr>
              <tr>
                <td>Controle (C)</td>
                <td><input type="number" id="CE" min="0" max="9" placeholder="0‚Äì9"></td>
                <td><input type="number" id="CD" min="0" max="9" placeholder="0‚Äì9"></td>
              </tr>
              <tr>
                <td>Afei√ß√£o (A)</td>
                <td><input type="number" id="AE" min="0" max="9" placeholder="0‚Äì9"></td>
                <td><input type="number" id="AD" min="0" max="9" placeholder="0‚Äì9"></td>
              </tr>
            </table>

            <div>
              <label for="obs">Observa√ß√µes r√°pidas / resumo da fam√≠lia</label>
              <input type="text" id="obs" placeholder="Ex.: casal idoso com suporte dos filhos, rotina organizada, boa comunica√ß√£o...">
            </div>

            <div class="legend">
              <div class="legend-col">
                <b>Intensidade (0‚Äì54)</b><br>
                0‚Äì15 muito baixa ¬∑ 16‚Äì30 moderada ¬∑ 31‚Äì45 alta ¬∑ 46‚Äì54 muito alta
              </div>
              <div class="legend-col">
                <b>Congru√™ncia (0‚Äì27)</b><br>
                0‚Äì6 boa ¬∑ 7‚Äì12 moderada ¬∑ ‚â•13 tens√£o alta (gaps E‚ÜîD)
              </div>
            </div>
          </section>

          <!-- LADO DIREITO: resultados + interpreta√ß√£o 1.1 -->
          <section class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <span style="font-weight:600;font-size:.9rem;">Leitura sint√©tica</span>
              <span class="small">Atualiza em tempo real</span>
            </div>

            <div id="painel">
              Preencha todas as pontua√ß√µes (0‚Äì9) em I, C e A para ver os indicadores.
            </div>

            <div style="height:1px;background:var(--border);margin:4px 0 2px;"></div>

            <div>
              <div class="block-title">1.1. F.I.R.O. ‚Äì Interpreta√ß√£o familiar</div>
              <ul class="point-list" id="interpretacao">
                <li><b>Resumo da fam√≠lia/caso:</b> utilize o campo de observa√ß√µes para gerar uma s√≠ntese autom√°tica.</li>
                <li><b>Inclus√£o:</b> ser√° descrita a qualidade da participa√ß√£o e do pertencimento entre os membros.</li>
                <li><b>Controle:</b> ser√° descrita a forma como se organizam responsabilidades e tomada de decis√£o.</li>
                <li><b>Afei√ß√£o:</b> ser√° descrito o padr√£o de trocas afetivas e apoio emocional.</li>
                <li><b>Conclus√£o:</b> ser√° gerada uma s√≠ntese do equil√≠brio entre inclus√£o, controle e afeto.</li>
              </ul>
            </div>
          </section>
        </div>

        <!-- BOT√ïES -->
        <div class="btns">
          <button id="btnVoltar">‚¨ÖÔ∏è Voltar</button>
          <button id="btnPrint">üñ®Ô∏è Imprimir</button>
          <button id="btnNext">‚û°Ô∏è Pr√≥ximo</button>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <span>Desenvolvido por <strong>Gabriel Ortega Antonio</strong></span>
    <span>M√≥dulo USF ‚Ä¢ FIRO</span>
  </footer>

<script>
(function(){
  const get = id => document.getElementById(id);
  const painel = get('painel');
  const interpretacaoEl = get('interpretacao');
  let firoPronto = false;

  function allFilled(arr){
    return arr.every(v => Number.isFinite(v));
  }

  function categoriaIntensidade(total){
    if(total <= 15) return { txt:'Intensidade muito baixa', pill:'pill-ok' };
    if(total <= 30) return { txt:'Intensidade moderada', pill:'pill-ok' };
    if(total <= 45) return { txt:'Intensidade alta', pill:'pill-warn' };
    return { txt:'Intensidade muito alta', pill:'pill-warn' };
  }

  function categoriaCongruencia(gapSum){
    if(gapSum <= 6)  return { txt:'Boa congru√™ncia (baixa tens√£o)', pill:'pill-ok' };
    if(gapSum <= 12) return { txt:'Congru√™ncia moderada', pill:'pill-warn' };
    return { txt:'Tens√£o alta (grandes gaps E‚ÜîD)', pill:'pill-bad' };
  }

  function nivel(x){
    if(x <= 2) return 'baixo';
    if(x <= 6) return 'moderado';
    return 'alto';
  }

  function descIntensidadeGlobal(total){
    if(total <= 15) return 'intensidade muito baixa de necessidades interpessoais, com menor demanda por contato, estrutura e trocas afetivas.';
    if(total <= 30) return 'intensidade moderada de necessidades interpessoais, compat√≠vel com funcionamento globalmente est√°vel.';
    if(total <= 45) return 'intensidade elevada de necessidades interpessoais, com forte investimento em contato, organiza√ß√£o e v√≠nculos afetivos.';
    return 'intensidade muito elevada de necessidades interpessoais, o que pode refletir alta demanda por presen√ßa, controle e proximidade emocional.';
  }

  function descCongruenciaGlobal(gapSum){
    if(gapSum <= 6)  return 'boa congru√™ncia entre o que √© expresso e o que √© desejado, sugerindo baixa tens√£o interna.';
    if(gapSum <= 12) return 'congru√™ncia intermedi√°ria, com algumas √°reas de poss√≠vel desalinhamento entre expectativas e pr√°ticas.';
    return 'tens√£o alta, com gaps relevantes entre express√£o e desejo nas rela√ß√µes, exigindo maior negocia√ß√£o e ajuste m√∫tuo.';
  }

  function focoDimensional(I, C, A){
    if(I >= C && I >= A) return 'com √™nfase ligeiramente maior em aspectos de inclus√£o e pertencimento.';
    if(C >= I && C >= A) return 'com destaque relativo para quest√µes de controle, organiza√ß√£o e tomada de decis√£o.';
    return 'com predomin√¢ncia de aspectos afetivos e de suporte emocional.';
  }

  function interpretarDim(nome, E, D){
    const gap = Math.abs(E - D);
    const nE = nivel(E);
    const nD = nivel(D);

    const ambosBaixos   = (nE === 'baixo'   && nD === 'baixo');
    const ambosModerados= (nE === 'moderado'&& nD === 'moderado');
    const ambosAltos    = (nE === 'alto'    && nD === 'alto');

    let base = '';

    function fraseEquilibrada(){
      if(nome === 'Inclus√£o'){
        if(ambosBaixos)   return 'Inclus√£o pouco central, com participa√ß√£o mais restrita nas atividades compartilhadas e rede de apoio menos mobilizada.';
        if(ambosAltos)    return 'Boa inclus√£o entre os membros, com forte participa√ß√£o, contato frequente e sensa√ß√£o de pertencimento.';
        return 'Inclus√£o em n√≠vel moderado, compat√≠vel com participa√ß√£o adequada e presen√ßa relativamente est√°vel nas rotinas do grupo.';
      }
      if(nome === 'Controle'){
        if(ambosBaixos)   return 'Controle pouco central, com organiza√ß√£o mais flex√≠vel e menor √™nfase em dirigir ou monitorar rigidamente as rotinas.';
        if(ambosAltos)    return 'Controle elevado, com forte tend√™ncia a estruturar, organizar e conduzir as decis√µes do grupo.';
        return 'Controle equilibrado, com divis√£o relativamente clara de responsabilidades e tomada de decis√£o compartilhada.';
      }
      if(nome === 'Afei√ß√£o'){
        if(ambosBaixos)   return 'Trocas afetivas mais contidas, com menor express√£o expl√≠cita de proximidade emocional e cuidado.';
        if(ambosAltos)    return 'Alto n√≠vel de afei√ß√£o, com v√≠nculos emocionais intensos, disponibilidade para escuta e apoio rec√≠proco.';
        return 'Afei√ß√£o em faixa intermedi√°ria, sustentando v√≠nculos est√°veis e espa√ßo razo√°vel para apoio emocional m√∫tuo.';
      }
      return '';
    }

    if(gap >= 5){
      if(nE === 'baixo' && nD === 'alto'){
        if(nome === 'Inclus√£o'){
          base = 'Baixa express√£o de inclus√£o associada a desejo elevado de pertencimento, sugerindo necessidade importante de maior participa√ß√£o e presen√ßa nas intera√ß√µes, com risco de viv√™ncias de car√™ncia ou exclus√£o.';
        }else if(nome === 'Controle'){
          base = 'Baixa express√£o de controle com desejo elevado de maior estrutura e dire√ß√£o, indicando busca por mais organiza√ß√£o e clareza na tomada de decis√£o, ainda pouco concretizada no cotidiano.';
        }else{
          base = 'Express√£o afetiva reduzida frente a desejo elevado de proximidade emocional, apontando para necessidades afetivas n√£o plenamente atendidas e poss√≠vel sensa√ß√£o de distanciamento.';
        }
      }else if(nE === 'alto' && nD === 'baixo'){
        if(nome === 'Inclus√£o'){
          base = 'Express√£o elevada de inclus√£o em um contexto de desejo mais baixo, sugerindo oferta de contato e presen√ßa acima do que √© efetivamente esperado, o que pode ser sentido como excesso ou invas√£o de espa√ßo.';
        }else if(nome === 'Controle'){
          base = 'Express√£o elevada de controle em contraste com desejo reduzido, indicando tend√™ncia a assumir ou dirigir mais do que se gostaria, com potencial de gerar assimetrias de poder ou conflitos de autonomia.';
        }else{
          base = 'Alto investimento afetivo diante de desejo mais contido de proximidade, apontando para oferta emocional acima do que √© demandado, possivelmente percebida como intensa ou invasiva.';
        }
      }else{
        if(nome === 'Inclus√£o'){
          base = 'H√° forte assimetria entre o quanto se participa/oferece inclus√£o e o quanto se deseja pertencer, sinalizando tens√£o nesse eixo de contato e presen√ßa.';
        }else if(nome === 'Controle'){
          base = 'Observa-se forte assimetria entre exercer e desejar controle, sugerindo desalinhamento importante na forma de organizar decis√µes e responsabilidades.';
        }else{
          base = 'Verifica-se forte assimetria entre a express√£o afetiva e o desejo de trocas emocionais, o que tende a gerar mal-entendidos e frustra√ß√µes.';
        }
      }
      return `<li><b>${nome}:</b> ${base}</li>`;
    }

    if(gap >= 3 && gap <= 4){
      if(nome === 'Inclus√£o'){
        base = 'Existem discrep√¢ncias moderadas entre o quanto a inclus√£o √© efetivamente vivida e o quanto √© desejada, sugerindo espa√ßo para negocia√ß√£o de participa√ß√£o e proximidade nas rotinas conjuntas.';
      }else if(nome === 'Controle'){
        base = 'O eixo de controle apresenta discrep√¢ncias moderadas entre express√£o e desejo, indicando necessidade de ajustes finos na defini√ß√£o de responsabilidades e na forma de tomar decis√µes.';
      }else{
        base = 'No campo afetivo, h√° diferen√ßas moderadas entre o que se oferece/recebe e o que se espera, apontando para ajustes poss√≠veis na qualidade e na intensidade das trocas emocionais.';
      }
      return `<li><b>${nome}:</b> ${base}</li>`;
    }

    base = fraseEquilibrada();
    return `<li><b>${nome}:</b> ${base}</li>`;
  }

  function interpretarConclusao(total, gapSum, I, C, A, obsTexto){
    const textoInt = descIntensidadeGlobal(total);
    const textoGap = descCongruenciaGlobal(gapSum);
    const foco = focoDimensional(I, C, A);

    let partes = [];

    if(obsTexto){
      partes.push(`<li><b>Resumo da fam√≠lia/caso:</b> ${obsTexto}</li>`);
    }

    partes.push(
      `<li><b>Conclus√£o:</b> O padr√£o global aponta para ${textoInt} Al√©m disso, observa-se ${textoGap} Em conjunto, trata-se de um arranjo relacional ${foco}</li>`
    );

    return partes.join('');
  }

  function calcFIRO(){
    const IE = Number(get('IE').value);
    const ID = Number(get('ID').value);
    const CE = Number(get('CE').value);
    const CD = Number(get('CD').value);
    const AE = Number(get('AE').value);
    const AD = Number(get('AD').value);

    const vals = [IE,ID,CE,CD,AE,AD];

    if(!allFilled(vals)){
      firoPronto = false;
      painel.innerHTML = 'Preencha todas as pontua√ß√µes (0‚Äì9) em Inclus√£o, Controle e Afei√ß√£o para gerar os indicadores.';
      interpretacaoEl.innerHTML = `
        <li><b>Resumo da fam√≠lia/caso:</b> utilize o campo de observa√ß√µes para gerar uma s√≠ntese autom√°tica.</li>
        <li><b>Inclus√£o:</b> ser√° descrita a qualidade da participa√ß√£o e do pertencimento entre os membros.</li>
        <li><b>Controle:</b> ser√° descrita a forma como se organizam responsabilidades e tomada de decis√£o.</li>
        <li><b>Afei√ß√£o:</b> ser√° descrito o padr√£o de trocas afetivas e apoio emocional.</li>
        <li><b>Conclus√£o:</b> ser√° gerada uma s√≠ntese do equil√≠brio entre inclus√£o, controle e afeto.</li>
      `;
      return;
    }

    const I    = IE + ID;
    const C    = CE + CD;
    const A    = AE + AD;
    const gapI = Math.abs(IE - ID);
    const gapC = Math.abs(CE - CD);
    const gapA = Math.abs(AE - AD);

    const total  = I + C + A;
    const gapSum = gapI + gapC + gapA;

    const catInt = categoriaIntensidade(total);
    const catGap = categoriaCongruencia(gapSum);

    const obs = get('obs').value.trim();

    painel.innerHTML = `
      <div class="kpis">
        <div class="kpi">
          <div>
            <div class="small">Intensidade interpessoal (0‚Äì54)</div>
            <div class="value">${total}</div>
            <div class="small">I: <b>${I}</b> ¬∑ C: <b>${C}</b> ¬∑ A: <b>${A}</b></div>
          </div>
          <span class="pill ${catInt.pill}">${catInt.txt}</span>
        </div>
        <div class="kpi">
          <div>
            <div class="small">Congru√™ncia E‚ÜîD (soma dos gaps, 0‚Äì27)</div>
            <div class="value">${gapSum}</div>
            <div class="small">Gaps ‚Äî I: <b>${gapI}</b> ¬∑ C: <b>${gapC}</b> ¬∑ A: <b>${gapA}</b></div>
          </div>
          <span class="pill ${catGap.pill}">${catGap.txt}</span>
        </div>
      </div>
      ${obs ? `<div class="small" style="margin-top:6px;"><b>S√≠ntese livre anotada:</b> ${obs}</div>` : ''}
    `;

    const linhaI   = interpretarDim('Inclus√£o', IE, ID);
    const linhaC   = interpretarDim('Controle', CE, CD);
    const linhaA   = interpretarDim('Afei√ß√£o',  AE, AD);
    const linhaConc= interpretarConclusao(total, gapSum, I, C, A, obs);

    interpretacaoEl.innerHTML = linhaI + linhaC + linhaA + linhaConc;

    firoPronto = true;
    localStorage.setItem('firoTotal', total);
    localStorage.setItem('firoGapSum', gapSum);
    localStorage.setItem('firoI', I);
    localStorage.setItem('firoC', C);
    localStorage.setItem('firoA', A);
    localStorage.setItem('firoGapI', gapI);
    localStorage.setItem('firoGapC', gapC);
    localStorage.setItem('firoGapA', gapA);
    localStorage.setItem('firoCatInt', catInt.txt);
    localStorage.setItem('firoCatGap', catGap.txt);
    localStorage.setItem('firoObs', obs);
  }

  document.addEventListener('input', e => {
    if(['IE','ID','CE','CD','AE','AD','obs'].includes(e.target.id)){
      calcFIRO();
    }
  });

  document.getElementById('btnVoltar').addEventListener('click', () => history.back());
  document.getElementById('btnPrint').addEventListener('click', () => window.print());
  document.getElementById('btnNext').addEventListener('click', () => {
    if(!firoPronto){
      alert('Preencha todas as pontua√ß√µes (0‚Äì9) em Inclus√£o, Controle e Afei√ß√£o antes de continuar.');
      return;
    }
    window.location.href = 'practice.html';
  });
})();
</script>
</body>
</html>
