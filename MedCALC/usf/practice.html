<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PRACTICE ‚Äì Avalia√ß√£o da Funcionalidade Familiar</title>

<style>
:root{
  --bg:#f5f5f7;
  --bg-section:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --focus:#4f46e5;
  --ok:#065f46;--ok-bg:#d1fae5;
  --warn:#92400e;--warn-bg:#ffedd5;
  --bad:#7f1d1d;--bad-bg:#fee2e2;
  --shadow-soft:0 18px 45px rgba(15,23,42,.12);
}

*{box-sizing:border-box;}

body{
  margin:0;
  background:radial-gradient(circle at top,#e5f0ff 0,#f5f5f7 45%,#f9fafb 100%);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  font-size:0.9rem;
}

a{
  color:inherit;
  text-decoration:none;
}

/* HEADER / NAVBAR */
header.site-header{
  position:sticky;
  top:0;
  z-index:10;
  backdrop-filter:blur(16px);
  background:linear-gradient(to bottom,rgba(245,245,247,.95),rgba(245,245,247,.86));
  border-bottom:1px solid rgba(209,213,219,.7);
}

.nav-inner{
  max-width:1100px;
  margin:0 auto;
  padding:12px 20px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:24px;
}

.brand{
  display:flex;
  align-items:center;
  gap:10px;
}

.brand-mark{
  width:28px;
  height:28px;
  border-radius:999px;
  border:1px solid #111827;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:.85rem;
  font-weight:600;
}

.brand-text{
  display:flex;
  flex-direction:column;
  line-height:1.2;
}

.brand-title{
  font-size:.95rem;
  font-weight:600;
}

.brand-subtitle{
  font-size:.7rem;
  text-transform:uppercase;
  letter-spacing:.16em;
  color:var(--muted);
}

.nav-links{
  display:flex;
  align-items:center;
  gap:16px;
  font-size:.82rem;
  color:var(--muted);
  flex-wrap:wrap;
}

.nav-back{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:5px 10px;
  border-radius:999px;
  border:1px solid #d1d5db;
  font-size:.78rem;
  background:#ffffff;
  cursor:pointer;
  transition:background .15s,transform .12s,color .15s;
}

.nav-back span:first-child{
  font-size:.9rem;
  transform:translateY(1px);
}

.nav-back:hover{
  background:#111827;
  color:#f9fafb;
  transform:translateY(-1px);
}

.nav-pill{
  padding:5px 10px;
  border-radius:999px;
  border:1px solid #d1d5db;
  font-size:.72rem;
  text-transform:uppercase;
  letter-spacing:.14em;
  background:#ffffff;
}

/* PAGE WRAPPER */
.page{
  max-width:900px;
  margin:0 auto;
  padding:28px 20px 60px;
}

/* HERO */
.hero-practice{
  margin-bottom:18px;
}

.hero-badge{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:4px 11px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.5);
  font-size:.75rem;
  letter-spacing:.16em;
  text-transform:uppercase;
  color:var(--muted);
  background:rgba(255,255,255,.85);
  backdrop-filter:blur(18px);
}

.hero-badge-dot{
  width:6px;
  height:6px;
  border-radius:999px;
  background:#22c55e;
  box-shadow:0 0 0 4px rgba(34,197,94,.2);
}

.hero-title{
  margin:14px 0 4px;
  font-size:clamp(1.7rem,2.3vw,2rem);
  line-height:1.1;
  letter-spacing:.02em;
}

.hero-title span{
  display:block;
  font-weight:300;
  color:var(--muted);
}

.hero-text{
  margin:0;
  margin-top:6px;
  font-size:.92rem;
  color:var(--muted);
  max-width:640px;
}

/* CARD WRAPPER (√°rea principal) */
.card-wrapper{
  background:var(--bg-section);
  border-radius:20px;
  border:1px solid rgba(209,213,219,.9);
  box-shadow:var(--shadow-soft);
  padding:18px 18px 18px;
}

/* CONTE√öDO ORIGINAL (printArea) */
#printArea h1{
  margin:0 0 8px;
  font-size:1.4rem;
}

#printArea .sub{
  color:var(--muted);
  margin:0 0 16px;
  font-size:.9rem;
}

.card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:12px;
  padding:14px;
  box-shadow:0 1px 2px rgba(0,0,0,.04);
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:6px;
}

th,td{
  padding:6px;
  border-bottom:1px solid var(--border);
  text-align:center;
}

th{
  background:#f9fafb;
  font-weight:600;
  font-size:.86rem;
}

td:first-child{
  text-align:left;
}

select{
  padding:6px 8px;
  border:1px solid var(--border);
  border-radius:8px;
  width:100%;
  font-size:0.86rem;
}

select:focus{
  border-color:var(--focus);
  box-shadow:0 0 0 3px rgba(79,70,229,.15);
  outline:none;
}

#obs{
  width:100%;
  padding:8px 10px;
  border:1px solid var(--border);
  border-radius:8px;
  font-size:.86rem;
}

.result-panel{
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  background:#fff;
  margin-top:12px;
}

.kpi{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}

.value{
  font-size:1.6rem;
  font-weight:800;
}

.pill{
  display:inline-block;
  padding:6px 10px;
  border-radius:999px;
  font-size:.85rem;
  font-weight:700;
}
.pill-ok{background:var(--ok-bg);color:var(--ok);}
.pill-warn{background:var(--warn-bg);color:var(--warn);}
.pill-bad{background:var(--bad-bg);color:var(--bad);}

.small{
  font-size:.82rem;
  color:var(--muted);
}

#interpretacao ul{
  margin:0;
  padding-left:18px;
}
#interpretacao li+li{
  margin-top:3px;
}

/* BOT√ïES */
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-top:14px;
}

.btn{
  background:var(--focus);
  color:#fff;
  border:none;
  padding:7px 12px;
  border-radius:999px;
  cursor:pointer;
  font-size:0.8rem;
  font-weight:600;
  box-shadow:0 4px 10px rgba(15,23,42,.2);
  display:inline-flex;
  align-items:center;
  gap:4px;
  transition:background .2s, transform .08s, box-shadow .2s;
}

.btn:hover{
  background:#3730a3;
  transform:translateY(-1px);
  box-shadow:0 8px 18px rgba(15,23,42,.25);
}

/* FOOTER */
footer.site-footer{
  border-top:1px solid rgba(209,213,219,.7);
  margin-top:32px;
  padding:14px 20px 20px;
  font-size:.8rem;
  color:var(--muted);
  display:flex;
  justify-content:space-between;
  gap:8px;
  flex-wrap:wrap;
  max-width:900px;
  margin-left:auto;
  margin-right:auto;
}
footer.site-footer strong{
  font-weight:500;
  color:#111827;
}

/* RESPONSIVO */
@media (max-width:640px){
  .nav-inner{
    flex-direction:column;
    align-items:flex-start;
  }
  .page{
    padding:22px 16px 40px;
  }
}

/* IMPRESS√ÉO ‚Äì A5 compacto: s√≥ conte√∫do do card */
@media print{
  header.site-header,
  footer.site-footer,
  .hero-practice{
    display:none !important;
  }

  body{
    background:#fff;
    font-size:0.7rem;
  }
  .page{
    max-width:none;
    padding:4px;
    margin:0;
  }
  .card-wrapper{
    border:none;
    box-shadow:none;
    padding:0;
  }

  @page{
    size:A5 portrait;
    margin:0.3cm;
  }

  #printArea h1{
    font-size:1rem;
    margin-bottom:2px;
  }
  #printArea .sub{
    display:none !important;
  }
  .card,
  .result-panel{
    box-shadow:none;
    border-color:#bbb;
    padding:5px;
    margin-top:4px;
    border-radius:4px;
  }
  table{
    margin-top:3px;
    font-size:0.6rem;
  }
  th,td{
    padding:3px;
  }
  th{
    font-size:0.6rem;
  }
  select{
    padding:3px 4px;
    font-size:0.6rem;
  }
  #obs{
    padding:3px 4px !important;
    font-size:0.6rem;
  }
  .kpi{
    gap:6px;
  }
  .value{
    font-size:0.9rem;
  }
  .pill{
    font-size:0.6rem;
    padding:3px 6px;
  }
  .small,
  #interpretacao ul{
    font-size:0.6rem;
  }
  .controls{
    display:none !important;
  }
}
</style>
</head>
<body>

  <!-- HEADER -->
  <header class="site-header">
    <div class="nav-inner">
      <div class="brand">
        <div class="brand-mark">M</div>
        <div class="brand-text">
          <div class="brand-title">Medicina Integrada</div>
          <div class="brand-subtitle">USF ‚Ä¢ PRACTICE</div>
        </div>
      </div>
      <nav class="nav-links">
        <a href="index.html" class="nav-back">
          <span>‚¨Ö</span>
          <span>Voltar √† USF</span>
        </a>
        <span class="nav-pill">PRACTICE</span>
      </nav>
    </div>
  </header>

  <main class="page">
    <!-- HERO -->
    <section class="hero-practice">
      <div class="hero-badge">
        <span class="hero-badge-dot"></span>
        AVALIA√á√ÉO FAMILIAR ‚Ä¢ PRACTICE
      </div>
      <h1 class="hero-title">
        PRACTICE ‚Äì Avalia√ß√£o da Funcionalidade Familiar
        <span>Instrumento multidimensional em oito dom√≠nios da din√¢mica familiar.</span>
      </h1>
      <p class="hero-text">
        Cada dom√≠nio (Problemas, Pap√©is, Resposta Afetiva, Comunica√ß√£o, Tempo, Envolvimento, Coping e Empatia)
        recebe uma pontua√ß√£o de 0 a 3. Ao final, o escore global e a interpreta√ß√£o qualitativa auxiliam na
        compreens√£o da funcionalidade familiar.
      </p>
    </section>

    <!-- CARD PRINCIPAL -->
    <section class="card-wrapper">
      <div id="printArea">
        <h1>PRACTICE ‚Äì Avalia√ß√£o da Funcionalidade Familiar</h1>
        <p class="sub">
          Instrumento multidimensional para avaliar a din√¢mica familiar segundo oito dom√≠nios:
          <b>Problemas, Pap√©is, Resposta Afetiva, Comunica√ß√£o, Tempo, Envolvimento, Coping e Empatia</b>.
        </p>

        <section class="card">
          <table>
            <tr><th>Dimens√£o</th><th>Pontua√ß√£o (0‚Äì3)</th></tr>
            <tr>
              <td>Problem Solving (Resolu√ß√£o de Problemas)</td>
              <td>
                <select id="P">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca / muito ruim</option>
                  <option value="1">1 ‚Äì √Äs vezes / regular</option>
                  <option value="2">2 ‚Äì Frequentemente / bom</option>
                  <option value="3">3 ‚Äì Sempre / excelente</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Roles (Pap√©is Familiares)</td>
              <td>
                <select id="R">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Affective Responsiveness (Resposta Afetiva)</td>
              <td>
                <select id="A">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Communication (Comunica√ß√£o)</td>
              <td>
                <select id="C1">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Time Spent Together (Tempo de Conviv√™ncia)</td>
              <td>
                <select id="T">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Involvement (Envolvimento)</td>
              <td>
                <select id="I">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Coping (Capacidade de Enfrentamento)</td>
              <td>
                <select id="C2">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>Empathy (Empatia)</td>
              <td>
                <select id="E">
                  <option value="">‚Äì</option>
                  <option value="0">0 ‚Äì Nunca</option>
                  <option value="1">1 ‚Äì √Äs vezes</option>
                  <option value="2">2 ‚Äì Frequentemente</option>
                  <option value="3">3 ‚Äì Sempre</option>
                </select>
              </td>
            </tr>
          </table>

          <div style="margin-top:10px">
            <label><b>Observa√ß√µes / resumo da fam√≠lia</b></label>
            <input type="text" id="obs" placeholder="Ex.: casal idoso, condi√ß√£o cr√¥nica, filho cuidador, limita√ß√µes funcionais, etc.">
          </div>
        </section>

        <!-- Painel num√©rico -->
        <div id="painel" class="result-panel">
          Selecione as respostas de cada dom√≠nio para obter o escore PRACTICE.
        </div>

        <!-- Painel interpretativo 1.4 PRACTICE -->
        <div id="interpretacao" class="result-panel">
          <div class="small"><b>1.4. P.R.A.C.T.I.C.E. ‚Äì Interpreta√ß√£o familiar</b></div>
          <ul>
            <li><b>Resumo da fam√≠lia/caso:</b> utilize o campo de observa√ß√µes para registrar condi√ß√£o cl√≠nica, arranjo familiar e outros elementos relevantes.</li>
            <li><b>P ‚Äì Problema apresentado:</b> ser√° descrita a forma como a fam√≠lia reconhece e maneja problemas de sa√∫de e demandas do cotidiano.</li>
            <li><b>R ‚Äì Pap√©is e estrutura:</b> ser√° analisada a organiza√ß√£o dos pap√©is no domic√≠lio e a distribui√ß√£o de responsabilidades.</li>
            <li><b>A ‚Äì Afeto:</b> ser√° avaliado o grau de proximidade emocional e clima afetivo.</li>
            <li><b>C ‚Äì Comunica√ß√£o:</b> ser√° descrita a abertura para di√°logo sobre decis√µes e quest√µes do cotidiano.</li>
            <li><b>T ‚Äì Tempo de conviv√™ncia:</b> ser√° avaliada a qualidade do tempo partilhado, considerando o momento do ciclo de vida.</li>
            <li><b>I ‚Äì Envolvimento/doen√ßa na fam√≠lia:</b> ser√° descrito o engajamento com o cuidado das condi√ß√µes cr√¥nicas e do tratamento.</li>
            <li><b>C ‚Äì Enfrentamento do estresse:</b> ser√° avaliada a capacidade de lidar com situa√ß√µes adversas.</li>
            <li><b>E ‚Äì Meio ambiente e rede de apoio:</b> ser√° descrita a rela√ß√£o com a rede de apoio, servi√ßos de sa√∫de e contexto comunit√°rio.</li>
          </ul>
        </div>

        <p class="small">
          <b>Interpreta√ß√£o global:</b><br>
          0‚Äì8 ‚Üí Disfun√ß√£o familiar grave ¬∑ 9‚Äì16 ‚Üí Disfun√ß√£o leve/moderada ¬∑ 17‚Äì24 ‚Üí Fam√≠lia funcional.<br>
          <b>Fonte:</b> Smilkstein G, 1978 ¬∑ Adaptado para Aten√ß√£o Prim√°ria √† Sa√∫de.
        </p>
      </div>

      <!-- BOT√ïES -->
      <div class="controls">
        <button class="btn" id="btnVoltar">‚¨ÖÔ∏è Voltar</button>
        <button class="btn" id="btnPrint">üñ®Ô∏è Imprimir</button>
        <button class="btn" id="btnNext">‚û°Ô∏è Pr√≥ximo</button>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <span>Desenvolvido por <strong>Gabriel Ortega Antonio</strong></span>
    <span>M√≥dulo USF ‚Ä¢ PRACTICE</span>
  </footer>

<script>
(function(){
  const ids=['P','R','A','C1','T','I','C2','E'];
  const get=id=>document.getElementById(id);
  const painel=get('painel');
  const interpPanel=get('interpretacao');
  let practicePronto = false;

  function catGlobal(total){
    if(total<=8)  return {txt:'Disfun√ß√£o grave',pill:'pill-bad',desc:'configurando disfun√ß√£o familiar importante, com preju√≠zo em v√°rios dom√≠nios da funcionalidade.'};
    if(total<=16) return {txt:'Disfun√ß√£o leve/moderada',pill:'pill-warn',desc:'indicando √°reas de fragilidade com risco de sobrecarga, embora com recursos preservados.'};
    return {txt:'Fam√≠lia funcional',pill:'pill-ok',desc:'sugerindo boa organiza√ß√£o global, com capacidade adaptativa preservada.'};
  }

  function frasePorScore(dom, val){
    switch(dom){
      case 'P':
        if(val===0) return 'demonstra grande dificuldade em reconhecer e manejar problemas de sa√∫de e situa√ß√µes do cotidiano, com risco de descompensa√ß√µes frequentes.';
        if(val===1) return 'reconhece parcialmente os problemas, mas o manejo √© irregular, alternando momentos de maior cuidado com per√≠odos de neglig√™ncia ou confus√£o.';
        if(val===2) return 'costuma identificar e manejar de forma satisfat√≥ria os problemas de sa√∫de e do dia a dia, buscando apoio quando necess√°rio.';
        return 'reconhece prontamente problemas de sa√∫de e demandas cotidianas e os maneja de forma estruturada, com ades√£o consistente √†s orienta√ß√µes e busca oportuna por suporte quando preciso.';
      case 'R':
        if(val===0) return 'apresenta pap√©is pouco definidos, com sobrecarga concentrada em poucos membros e fragilidade na organiza√ß√£o das tarefas do lar.';
        if(val===1) return 'possui pap√©is parcialmente organizados, mas ainda com zonas de ambiguidade e necessidade de maior clareza na divis√£o das responsabilidades.';
        if(val===2) return 'apresenta pap√©is relativamente bem definidos, com divis√£o de tarefas geralmente adequada e suporte entre os membros quando necess√°rio.';
        return 'apresenta pap√©is e estrutura bem organizados, com divis√£o equilibrada das responsabilidades e apoio eficiente entre os membros quando demandado.';
      case 'A':
        if(val===0) return 'apresenta clima afetivo empobrecido, com poucas demonstra√ß√µes de cuidado, acolhimento e valida√ß√£o emocional.';
        if(val===1) return 'apresenta afeto presente, por√©m irregular, com momentos de aproxima√ß√£o alternando com alguma frieza ou distanciamento.';
        if(val===2) return 'mant√©m bom padr√£o afetivo, com demonstra√ß√µes de cuidado, respeito e apoio na maior parte das intera√ß√µes.';
        return 'apresenta rela√ß√£o afetiva fortalecida, com momentos em fam√≠lia valorizados e clima emocional predominantemente positivo.';
      case 'C1':
        if(val===0) return 'possui comunica√ß√£o bastante prejudicada, com pouca abertura para di√°logo e elevada chance de mal-entendidos.';
        if(val===1) return 'apresenta comunica√ß√£o parcialmente aberta, por√©m ainda marcada por ru√≠dos, omiss√µes ou dificuldade em tratar temas delicados.';
        if(val===2) return 'mant√©m comunica√ß√£o geralmente eficaz, conseguindo discutir decis√µes importantes e quest√µes do dia a dia com razo√°vel clareza.';
        return 'apresenta comunica√ß√£o eficaz, com troca aberta sobre decis√µes relevantes e manejo dialogado das quest√µes do cotidiano.';
      case 'T':
        if(val===0) return 'disp√µe de tempo muito limitado para conviv√™ncia de qualidade, o que fragiliza o suporte m√∫tuo no contexto atual do ciclo de vida.';
        if(val===1) return 'apresenta conviv√™ncia irregular, com momentos de aproxima√ß√£o, mas tamb√©m per√≠odos de pouca intera√ß√£o estruturada.';
        if(val===2) return 'disp√µe de tempo razo√°vel de conviv√™ncia, favorecendo acompanhamento das necessidades e manuten√ß√£o da autonomia.';
        return 'valoriza o tempo compartilhado, buscando compatibilizar conviv√™ncia, autocuidado e manuten√ß√£o do bem-estar na fase atual do ciclo de vida.';
      case 'I':
        if(val===0) return 'mostra baixo envolvimento com o cuidado da sa√∫de e com as demandas familiares, com risco de abandono ou delega√ß√£o excessiva a terceiros.';
        if(val===1) return 'apresenta envolvimento parcial com o cuidado, com oscila√ß√µes na participa√ß√£o de diferentes membros da fam√≠lia.';
        if(val===2) return 'demonstra envolvimento satisfat√≥rio com o cuidado das condi√ß√µes de sa√∫de e da rotina familiar, com compartilhamento razo√°vel de tarefas.';
        return 'apresenta envolvimento consistente com o cuidado, com participa√ß√£o ativa dos membros e suporte frequente entre si.';
      case 'C2':
        if(val===0) return 'apresenta coping bastante fragilizado, com dificuldade de lidar com situa√ß√µes adversas e maior vulnerabilidade a estresse.';
        if(val===1) return 'possui estrat√©gias de enfrentamento parcialmente eficazes, por√©m ainda sujeitas a se desorganizar diante de demandas mais intensas.';
        if(val===2) return 'costuma lidar de forma razo√°vel com situa√ß√µes estressoras, recorrendo √† rede de apoio e a servi√ßos de sa√∫de quando necess√°rio.';
        return 'lida bem com o estresse, mobilizando suporte m√∫tuo e recursos dispon√≠veis (incluindo os servi√ßos de sa√∫de e comunidade) para enfrentar crises e mudan√ßas.';
      case 'E':
        if(val===0) return 'apresenta baixa empatia entre os membros e pouca integra√ß√£o com a rede externa, o que limita a utiliza√ß√£o de recursos comunit√°rios e de sa√∫de.';
        if(val===1) return 'demonstra alguma empatia e contato com o ambiente e servi√ßos, por√©m ainda de forma espor√°dica e pouco estruturada.';
        if(val===2) return 'mant√©m bom n√≠vel de empatia interna e rela√ß√£o razo√°vel com a rede de apoio, incluindo servi√ßos de sa√∫de e recursos comunit√°rios.';
        return 'apresenta boa empatia entre os membros, al√©m de rela√ß√£o positiva com a rede de apoio e acesso satisfat√≥rio ao sistema de sa√∫de e aos recursos comunit√°rios.';
      default:
        return '';
    }
  }

  function calcPractice(){
    const vals=ids.map(v=>get(v).value===''?NaN:Number(get(v).value));
    const obs=get('obs').value.trim();

    if(vals.some(isNaN)){
      practicePronto = false;
      painel.textContent='Responda todos os itens (0‚Äì3) para calcular o escore.';
      interpPanel.innerHTML = `
        <div class="small"><b>1.4. P.R.A.C.T.I.C.E. ‚Äì Interpreta√ß√£o familiar</b></div>
        <ul>
          <li><b>Resumo da fam√≠lia/caso:</b> utilize o campo de observa√ß√µes para registrar condi√ß√£o cl√≠nica, arranjo familiar e outros elementos relevantes.</li>
          <li><b>P ‚Äì Problema apresentado:</b> ser√° descrita a forma como a fam√≠lia reconhece e maneja problemas de sa√∫de e demandas do cotidiano.</li>
          <li><b>R ‚Äì Pap√©is e estrutura:</b> ser√° analisada a organiza√ß√£o dos pap√©is no domic√≠lio e a distribui√ß√£o de responsabilidades.</li>
          <li><b>A ‚Äì Afeto:</b> ser√° avaliado o grau de proximidade emocional e clima afetivo.</li>
          <li><b>C ‚Äì Comunica√ß√£o:</b> ser√° descrita a abertura para di√°logo sobre decis√µes e quest√µes do cotidiano.</li>
          <li><b>T ‚Äì Tempo de conviv√™ncia:</b> ser√° avaliada a qualidade do tempo partilhado, considerando o momento do ciclo de vida.</li>
          <li><b>I ‚Äì Envolvimento/doen√ßa na fam√≠lia:</b> ser√° descrito o engajamento com o cuidado das condi√ß√µes cr√¥nicas e do tratamento.</li>
          <li><b>C ‚Äì Enfrentamento do estresse:</b> ser√° avaliada a capacidade de lidar com situa√ß√µes adversas.</li>
          <li><b>E ‚Äì Meio ambiente e rede de apoio:</b> ser√° descrita a rela√ß√£o com a rede de apoio, servi√ßos de sa√∫de e contexto comunit√°rio.</li>
        </ul>
      `;
      return;
    }

    const total=vals.reduce((a,b)=>a+b,0);
    const cat=catGlobal(total);

    painel.innerHTML=`
      <div class="kpi">
        <div>
          <div class="small">Escore PRACTICE</div>
          <div class="value">${total}</div>
        </div>
        <span class="pill ${cat.pill}">${cat.txt}</span>
      </div>
      ${obs?`<div class="small" style="margin-top:6px"><b>Resumo anotado:</b> ${obs}</div>`:''}
    `;

    const [p,r,a,c1,t,i,c2,e] = vals;
    const linhas = [];

    if(obs){
      linhas.push(`<li><b>Resumo da fam√≠lia/caso:</b> ${obs}</li>`);
    }

    linhas.push(`<li><b>P ‚Äì Problema apresentado:</b> ${frasePorScore('P',p)}</li>`);
    linhas.push(`<li><b>R ‚Äì Pap√©is e estrutura:</b> ${frasePorScore('R',r)}</li>`);
    linhas.push(`<li><b>A ‚Äì Afeto:</b> ${frasePorScore('A',a)}</li>`);
    linhas.push(`<li><b>C ‚Äì Comunica√ß√£o:</b> ${frasePorScore('C1',c1)}</li>`);
    linhas.push(`<li><b>T ‚Äì Tempo de conviv√™ncia:</b> ${frasePorScore('T',t)}</li>`);
    linhas.push(`<li><b>I ‚Äì Envolvimento/doen√ßa na fam√≠lia:</b> ${frasePorScore('I',i)}</li>`);
    linhas.push(`<li><b>C ‚Äì Enfrentamento do estresse:</b> ${frasePorScore('C2',c2)}</li>`);
    linhas.push(`<li><b>E ‚Äì Meio ambiente e rede de apoio:</b> ${frasePorScore('E',e)}</li>`);
    linhas.push(`<li><b>Conclus√£o:</b> O conjunto dos dom√≠nios resulta em ${cat.txt.toLowerCase()}, ${cat.desc}</li>`);

    interpPanel.innerHTML = `
      <div class="small"><b>1.4. P.R.A.C.T.I.C.E. ‚Äì Interpreta√ß√£o familiar</b></div>
      <ul>${linhas.join('')}</ul>
    `;

    practicePronto = true;
    localStorage.setItem('practiceTotal', total);
    localStorage.setItem('practiceCat', cat.txt);
    localStorage.setItem('practiceDesc', cat.desc);
    localStorage.setItem('practiceObs', obs);
    localStorage.setItem('practiceP', p);
    localStorage.setItem('practiceR', r);
    localStorage.setItem('practiceA', a);
    localStorage.setItem('practiceC1', c1);
    localStorage.setItem('practiceT', t);
    localStorage.setItem('practiceI', i);
    localStorage.setItem('practiceC2', c2);
    localStorage.setItem('practiceE', e);
  }

  document.addEventListener('change', e=>{
    if(ids.includes(e.target.id) || e.target.id==='obs') calcPractice();
  });

  document.getElementById('btnVoltar').addEventListener('click', ()=> history.back());
  document.getElementById('btnPrint').addEventListener('click', ()=> window.print());
  document.getElementById('btnNext').addEventListener('click', ()=>{
    if(!practicePronto){
      alert('Preencha todos os dom√≠nios do PRACTICE antes de continuar.');
      return;
    }
    window.location.href = 'resultadofinal.html';
  });
})();
</script>
</body>
</html>
